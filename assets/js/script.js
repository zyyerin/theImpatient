const BOX_NUM=4;const CARD_NUM=31;let count=[];$(document).ready(function(){$('#loader').delay(4000).fadeOut(1000);init();stage(1);stage(2);stage(3);$(".imgHolder").click(function(){if(!$(this).hasClass('init')&&!$(this).hasClass('cardFlip0')){if(!$(this).hasClass("bluing")){$(this).addClass("bluing")}else{$(this).removeClass("bluing imgHolder").addClass("blued").css({"background-image":"none"}).off()}}});$("textarea").keypress(function(){let dropNum=$('.blued').length;let dropIdx=shuffle(dropNum)-1;if(dropNum>0){$(".blued").eq(dropIdx).css({"background-size":"initial",'background-image':'url(assets/drops/'+shuffle(35)+'.png)'})};let sum=count.reduce((a,b)=>a+b,0);if(sum<50){let noise=document.getElementById("bgm1");noise.volume=sum/200;noise.loop=!0;noise.play()}else if(sum<100){let bgm=document.getElementById("bgm2");bgm.loop=!0;bgm.volum=0.2;bgm.play()}else if(sum<150){let bgm=document.getElementById("bgm3");bgm.loop=!0;bgm.volum=0.3;bgm.play()}else if(sum<200){let bgm=document.getElementById("bgm4");bgm.volum=0.4;bgm.loop=!0;bgm.play()}else{let bgm=document.getElementById("bgm5");bgm.volum=0.5;bgm.loop=!0;bgm.play()}});$("#intro").click(function(){$(this).toggleClass("textBox infoed introed")});$("#share").click(function(){$(this).toggleClass("textBox infoed shared")})});function init(){for(let j=1;j<=BOX_NUM;j++){for(let i=1;i<=CARD_NUM;i++){$('.box:nth-child('+j+') .card:nth-child('+i+')').css('order',shuffle(CARD_NUM))}}
$('.imgHolder').each(function(idx){$(this).css({"background-image":"url(assets/cards/"+(1+idx)+".png)","background-size":"cover","background-position":"center","background-repeat":"no-repeat","background-color":"white"})})}
function flipCards(){let boxIdx=shuffle(BOX_NUM);let cardIdx=shuffle(CARD_NUM);let choosenCard='.box:nth-child('+boxIdx+') .imgHolder:nth-child('+cardIdx+')';$(choosenCard).removeClass('init').css('transition',shuffle(4)+'s').toggleClass('cardFlip0')}
function stage(stageIdx){count[stageIdx]=0;$('#input'+stageIdx).focusin(function(){let typeScale=0;$(this).removeClass('current')}).focus(function(){$(this).keypress(function(){let sound=document.getElementById("chime"+shuffle(10));sound.volume=0.3;sound.play();count[stageIdx]=$(this).val().length;typeScale=count[stageIdx]*0.03;$(this).css({'font-size':typeScale+'em','color':'red'});flipCards()})}).focusout(function(){if(count[stageIdx]!==0){stageIdx++};if(stageIdx<4){$('#input'+stageIdx).addClass('current')}})}
function shuffle(n){return Math.floor(Math.random()*n)+1}